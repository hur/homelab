resources:
  - name: homelab-git
    type: git
    icon: tea
    source:
      uri: https://git.atte.cloud/ops/homelab.git
      branch: develop

jobs:
  - name: configure-self
    plan:
      - get: homelab-git
        trigger: true
      - set_pipeline: manage-pipelines
        file: platform/concourse/pipelines/main/bootstrap.yaml
  - name: configure-pipelines
    plan:
      - get: homelab-git
        trigger: true
        passed: [configure-self]
      - set_pipeline: blog
        file: platform/concourse/pipelines/main/blog.yaml
      - set_pipeline: blog-pr
        file: platform/concourse/pipelines/main/blog-pr.yaml
